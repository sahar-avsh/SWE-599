{% extends 'mindspace/base.html' %}

{% load resource_filename_filter %}
{% load embed_video_tags %}

{% load static %}
{% block styles %}
  <link rel="stylesheet" type="text/css" href="{% static 'mindspace/resource_detail.css' %}">
{% endblock styles %}
{% block js %}
  <script src="{% static 'mindspace/dropdown.js' %}"></script>
{% endblock js %}

{% block title %}
    {{block.super}} - Resource
{% endblock title %}

{% block navbar %}

  <ul>
    <li><a href={% url 'main_page' %}>Home</a></li>
    <li><a class="active" href={% url 'mindspace:mindspace_list' %}>Dashboard</a></li>
    <li><a href={% url 'profiles:profile_detail' id=request.user.profile.id %}>Profile</a></li>
    <li><a href="#">Q&A</a></li>
    <li style="float:right"><a href={% url 'logout' %}>Logout</a></li>
    <li style="float:right"><a href="#">Notifications</a></li>

    <div class="dropdown">
      <button onclick="myFunction()" class="dropbtn">Actions</button>
      <div id="myDropdown" class="dropdown-content">
        <a href={% url 'mindspace:resource_update' ms_id=object.belongs_to.id id=object.id %}>Edit</a>
        <a href={% url 'mindspace:resource_delete' ms_id=object.belongs_to.id id=object.id %}>Delete</a>
        <a href="#contact">Clicked</a>
      </div>
    </div>
  </ul>

{% endblock navbar %}

{% block content %}

  <div class="container-fluid">

      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a class="breadcrumb-parent" href="{{object.belongs_to.get_absolute_url}}"> {{object.belongs_to.title}} </a></li>
        <li class="breadcrumb-item active" aria-current="page"> {{object.title}} </li>
      </ol>

    <div class="card text-center">
      <div class="card-header">
        Resource
      </div>
      <div class="card-body">
        <h5 class="card-title"> {{object.title}} </h5>
        {% comment %} Format is an uploaded image {% endcomment %}
        {% if object.res_format == 'Image' and object.image %}
          <img src="{{ object.image.url }}" width='600' height='400'>
        {% comment %} Format is an uploaded video {% endcomment %}
        {% elif object.res_format == 'Video' and object.video %}
          <video width='600' controls>
            <source src="{{ object.video.url }}" type='video/mp4'>
            Your browser does not support the video tag.
          </video>
        {% comment %} Format is a link-provided Youtube/Vimeo video {% endcomment %}
        {% elif object.res_format == 'Video' and object.link %}
          <!-- The video tag: -->
          {% video object.link as my_video %}
{% comment %}             URL: {{ my_video.url }}
            Thumbnail: {{ my_video.thumbnail }}
            Backend: {{ my_video.backend }} {% endcomment %}
            {% video my_video "medium" %}
          {% endvideo %}
        {% comment %} Format is a PDF document {% endcomment %}
        {% elif object.res_format == 'Document' and object.document %}
          {% comment %} <embed src="{{ object.document.url }}" width="500" height="375" type="application/pdf"> {% endcomment %}
          <div id="adobe-dc-view"></div>
          <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
          <script type="text/javascript">
            document.addEventListener("adobe_dc_view_sdk.ready", function()
            {
                var adobeDCView = new AdobeDC.View({clientId: "a0ddab820a7e4146a30c262d3d77bf55", divId: "adobe-dc-view"});
                adobeDCView.previewFile(
                {
                  content:   {location: {url: "{{ object.document.url }}"}},
                  metaData: {fileName: "{{ object.document.name|modify_filename }}"}
                });
            });
          </script>
        {% elif object.res_format == 'Quote' and object.quote %}
          <p class="lead"> {{ object.quote }} </p>
        {% elif object.res_format == 'Link' and object.link %}
          <a href="{{object.link}}" class="link-field" target="_blank" rel="noopener"> {{object.link}} </a> 
        {% endif %}
        <p class="card-text"> {{object.description}} </p>
      </div>
      <div class="card-footer text-muted">
        Created at {{object.created_at|date:"l j M Y - H:i"}}
      </div>
    </div>

    <h2>Your Notes</h2>

  </div>

{% endblock content %}